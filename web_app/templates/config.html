{% extends "base.html" %}

{% block title %}配置管理 - 自动化运维工具{% endblock %}

{% block content %}
<h2>配置管理</h2>

<div class="config-section">
    <h3>设备配置</h3>
    <p>在这里您可以管理设备的配置信息。</p>
    <div class="button-group">
        <button id="toggle-device-configs" class="btn btn-gradient" onclick="toggleDeviceConfigs()">查看设备配置</button>
    </div>
    
    <!-- 设备配置文件列表，默认隐藏 -->
    <div id="device-configs-list" style="display: none;">
        {% if config_files %}
        <div class="config-files-list">
            <h4>设备配置文件列表</h4>
            <table id="config-table" class="table table-striped table-hover resizable-table">
                <thead class="thead-dark">
                    <tr>
                        <th class="filename-col resizable-col">文件名<div class="resize-handle"></div></th>
                        <th class="size-col resizable-col">大小 (字节)<div class="resize-handle"></div></th>
                        <th class="date-col resizable-col">修改时间<div class="resize-handle"></div></th>
                        <th class="action-col resizable-col">操作<div class="resize-handle"></div></th>
                    </tr>
                </thead>
                <tbody>
                    {% for file in config_files %}
                    <tr>
                        <td class="filename-col resizable-col">{{ file.filename }}</td>
                        <td class="size-col resizable-col">{{ file.size }}</td>
                        <td class="date-col resizable-col">{{ file.mtime|datetimeformat('%Y-%m-%d %H:%M:%S') }}</td>
                        <td class="action-col resizable-col action-buttons">
                            <a href="{{ url_for('view_config_file', filename=file.filename) }}" class="btn btn-sm btn-primary action-btn">查看</a>
                            <a href="{{ url_for('edit_config', filename=file.filename) }}" class="btn btn-sm btn-warning action-btn">编辑</a>
                            <button class="btn btn-sm btn-danger action-btn" onclick="deleteConfig('{{ file.filename }}')">删除</button>
                            <button class="btn btn-sm btn-info action-btn" onclick="backupConfig('{{ file.filename }}')">备份</button>
                            <button class="btn btn-sm btn-success action-btn" onclick="restoreConfig('{{ file.filename }}')">恢复</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="config-files-list">
            <p>暂无设备配置文件</p>
        </div>
        {% endif %}
    </div>
</div>

<div class="config-section">
    <h3>规则配置</h3>
    <p>在这里您可以管理基线检查的规则配置。</p>
    <div class="button-group">
        <button id="toggle-rule-configs" class="btn btn-gradient" onclick="toggleRuleConfigs()">查看规则配置</button>
    </div>
    <!-- 规则配置文件列表，默认隐藏 -->
    <div id="rule-configs-list" style="display: none;">
        <div class="config-files-list">
            <p>加载中...</p>
        </div>
    </div>
</div>

<div class="config-section">
    <h3>系统设置</h3>
    <p>在这里您可以管理系统的一般设置。</p>
    <div class="button-group">
        <button id="toggle-system-configs" class="btn btn-gradient" onclick="toggleSystemConfigs()">查看系统设置</button>
    </div>
    <!-- 系统设置文件列表，默认隐藏 -->
    <div id="system-configs-list" style="display: none;">
        <div class="config-files-list">
            <p>加载中...</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/config.css') }}?v=1.1">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/config.js') }}"></script>
{% endblock %}